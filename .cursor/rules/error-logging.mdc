---
description: Error logging conventions - always include readable context for debugging
globs: src/**/*.ts
alwaysApply: false
---

# Error Logging

Every log statement must include relevant contextual data for debugging. Use Pino's structured logging via `request.log` or `fastify.log`.

## Rules

1. Always pass the error object as `err` (Pino serializes stack trace + message)
2. Include all relevant entity IDs for correlation (planId, itemId, etc.)
3. Write a human-readable message as the second argument describing what failed
4. Info logs for successful operations must include result metadata (count, ID)

## Examples

```typescript
// BAD - no context, impossible to debug
request.log.error('Something went wrong')
request.log.error({ err: error }, 'Error')

// GOOD - full context: error object, entity IDs, readable message
request.log.error({ err: error, planId }, 'Failed to retrieve plan items')
request.log.error({ err: error, planId, itemId }, 'Failed to update item status')

// BAD - missing result metadata
request.log.info('Items retrieved')

// GOOD - includes entity ID and result count
request.log.info({ planId, count: items.length }, 'Plan items retrieved')
request.log.info({ itemId, planId }, 'Item created')
```
